# Architecture & Implementation Plan  
Remote Patient Monitoring (RPM) for Diabetes Wearables

## Service Mapping

| Layer | Service (GCP) | Role in Solution | Related Module |
|------|---------------|------------------|----------------|
| Frontend / API | Cloud Run | Hosts Flask web app for uploads and clinician dashboard | Containers |
| Storage | Cloud Storage | Stores raw and validated CGM data files | Cloud Storage |
| Serverless | Cloud Functions | Validation, standardization, and scheduled analytics | Serverless |
| Database | Cloud SQL | Stores glucose readings and weekly summary tables | SQL Databases |
| Security | IAM & Secret Manager(this securely stores API keys and other sensitive data) | Access control and credential management | Cloud Security |

## Architecture Overview
The solution uses a serverless and container-based architecture to support intermittent workloads typical of RPM programs. Cloud Run hosts a containerized Flask application for file uploads and clinician access. Cloud Storage serves as the landing zone for raw and validated CGM data. Cloud Functions validate incoming data and run scheduled analytics jobs. Cloud SQL stores both cleaned readings and aggregated summaries.

## Data Flow Narrative
1. CGM data is generated by Dexcom or FreeStyle Libre devices  
2. Data is securely transferred to the cloud via uploads or simulated feeds  
3. Raw files are stored in Cloud Storage  
4. A Cloud Function triggers on upload to:
   - validate schema and required fields
   - standardize vendor-specific formats   
5. Cleaned readings are loaded into Cloud SQL tables  
6. A scheduled Cloud Function runs weekly analytics to compute:
   - time-in-range
   - hypo/hyperglycemia exposure
   - summary alert flags  
7. The Flask dashboard queries summary tables for clinician review  

## Security, Identity, and Governance
Secrets such as database credentials are stored in Secret Manager and injected into services at runtime. IAM roles follow the principle of least privilege, ensuring Cloud Run and Cloud Functions only access required resources. The system uses tokenized patient identifiers and explicitly rejects files containing direct PHI fields. In a real clinical deployment, additional controls such as private networking, audit logging, and HIPAA agreements would be required.

## Cost and Operational Considerations
Serverless services reduce costs by scaling to zero during idle periods. Cloud Storage costs remain low for CSV/JSON data. Cloud SQL represents the primary cost driver, so small instance sizes and limited data retention are used. Scheduled analytics jobs avoid always-on compute and improve cost efficiency.
